
## Load data


```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
```


```python
activity = pd.read_csv("data/brazil_activity.csv")
```

    /home/users/s17011720/.conda/envs/jupyter/lib/python3.7/site-packages/IPython/core/interactiveshell.py:3166: DtypeWarning: Columns (1,2,3,40) have mixed types.Specify dtype option on import or set low_memory=False.
      interactivity=interactivity, compiler=compiler, result=result)



```python
draw = pd.read_csv("data/brazil_draw.csv")
play = pd.read_csv("data/brazil_play.csv")
stage = pd.read_csv("data/brazil_stage.csv")
tutorial = pd.read_csv("data/brazil_tutorial.csv")
```


```python
activity.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>items</th>
      <th>traffic_source_medium</th>
      <th>traffic_source_source</th>
      <th>traffic_source_name</th>
      <th>event_previous_timestamp</th>
      <th>ga_session_number</th>
      <th>ga_session_number_timestamp</th>
      <th>user_level</th>
      <th>user_level_timestamp</th>
      <th>frist_version</th>
      <th>...</th>
      <th>activity_name</th>
      <th>action_name</th>
      <th>activity_id</th>
      <th>action_id</th>
      <th>firebase_event_origin</th>
      <th>ga_session_number_1</th>
      <th>sub_name</th>
      <th>user_first_touch_timestamp</th>
      <th>stream_id</th>
      <th>event_timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619310e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>111</td>
      <td>1619310355711000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>11.0</td>
      <td>firefighter</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310355712000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619311e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>116</td>
      <td>1619310716820000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>close_collection</td>
      <td>3</td>
      <td>3002</td>
      <td>app</td>
      <td>11.0</td>
      <td>0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310716820000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619538999255000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>doctor</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619538999256000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619309e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>110</td>
      <td>1619310280808000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>open_collection</td>
      <td>3</td>
      <td>3001</td>
      <td>app</td>
      <td>11.0</td>
      <td>0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310280808000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619539036765000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>police</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619539036766000</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 88 columns</p>
</div>




```python
activity.shape
```




    (1210979, 88)



# Data Cleaning

## See how many missing data points we have


```python
missing_values_count = activity.isnull().sum()
missing_values_count[0:10]
```




    items                               0
    traffic_source_medium          196002
    traffic_source_source          196002
    traffic_source_name            284690
    event_previous_timestamp       160763
    ga_session_number                 207
    ga_session_number_timestamp       207
    user_level                          0
    user_level_timestamp                0
    frist_version                      28
    dtype: int64



### 데이터 세트의 값 중 몇 퍼센트가 누락되었는지 확인


```python
# how many total missing values do we have?
total_cells = np.product(activity.shape)
total_missing = missing_values_count.sum()

# percent of data that is missing
(total_missing/total_cells) * 100
```




    18.352279436720206



데이터 세트에 있는 셀의 거의 1/5이 비어 있다


```python
# Percentage of NAN Values 
NAN = [(c, activity[c].isna().mean()*100) for c in activity]
NAN = pd.DataFrame(NAN, columns=["column_name", "percentage"])
```


```python
# Features with more than 50% of missing values.
NAN = NAN[NAN.percentage > 50]
NAN.sort_values("percentage", ascending=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>column_name</th>
      <th>percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23</th>
      <td>firebase_exp_4</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>24</th>
      <td>firebase_exp_4_timestamp</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>39</th>
      <td>last_gclid</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>43</th>
      <td>_ltv_BRL</td>
      <td>99.998018</td>
    </tr>
    <tr>
      <th>44</th>
      <td>_ltv_BRL_timestamp</td>
      <td>99.998018</td>
    </tr>
    <tr>
      <th>41</th>
      <td>_ltv_USD</td>
      <td>99.982328</td>
    </tr>
    <tr>
      <th>42</th>
      <td>_ltv_USD_timestamp</td>
      <td>99.982328</td>
    </tr>
    <tr>
      <th>40</th>
      <td>last_gclid_1</td>
      <td>99.619316</td>
    </tr>
    <tr>
      <th>37</th>
      <td>firebase_last_notification</td>
      <td>95.956247</td>
    </tr>
    <tr>
      <th>38</th>
      <td>firebase_last_notification_timestamp</td>
      <td>95.956247</td>
    </tr>
    <tr>
      <th>33</th>
      <td>firebase_exp_2</td>
      <td>87.531328</td>
    </tr>
    <tr>
      <th>34</th>
      <td>firebase_exp_2_timestamp</td>
      <td>87.531328</td>
    </tr>
    <tr>
      <th>35</th>
      <td>firebase_exp_3</td>
      <td>87.530998</td>
    </tr>
    <tr>
      <th>36</th>
      <td>firebase_exp_3_timestamp</td>
      <td>87.530998</td>
    </tr>
  </tbody>
</table>
</div>




```python
NAN_cols = NAN['column_name'].to_list()
```


```python
activity = activity.drop([NAN_cols],axis=1)
```


    ---------------------------------------------------------------------------

    KeyError                                  Traceback (most recent call last)

    <ipython-input-44-0c0c5289f3ec> in <module>
    ----> 1 activity = activity.drop([NAN_cols],axis=1)
    

    ~/.conda/envs/jupyter/lib/python3.7/site-packages/pandas/core/frame.py in drop(self, labels, axis, index, columns, level, inplace, errors)
       4172             level=level,
       4173             inplace=inplace,
    -> 4174             errors=errors,
       4175         )
       4176 


    ~/.conda/envs/jupyter/lib/python3.7/site-packages/pandas/core/generic.py in drop(self, labels, axis, index, columns, level, inplace, errors)
       3887         for axis, labels in axes.items():
       3888             if labels is not None:
    -> 3889                 obj = obj._drop_axis(labels, axis, level=level, errors=errors)
       3890 
       3891         if inplace:


    ~/.conda/envs/jupyter/lib/python3.7/site-packages/pandas/core/generic.py in _drop_axis(self, labels, axis, level, errors)
       3921                 new_axis = axis.drop(labels, level=level, errors=errors)
       3922             else:
    -> 3923                 new_axis = axis.drop(labels, errors=errors)
       3924             result = self.reindex(**{axis_name: new_axis})
       3925 


    ~/.conda/envs/jupyter/lib/python3.7/site-packages/pandas/core/indexes/base.py in drop(self, labels, errors)
       5285         if mask.any():
       5286             if errors != "ignore":
    -> 5287                 raise KeyError(f"{labels[mask]} not found in axis")
       5288             indexer = indexer[~mask]
       5289         return self.delete(indexer)


    KeyError: "[('firebase_exp_4', 'firebase_exp_4_timestamp', 'firebase_exp_2', 'firebase_exp_2_timestamp', 'firebase_exp_3', 'firebase_exp_3_timestamp', 'firebase_last_notification', 'firebase_last_notification_timestamp', 'last_gclid', 'last_gclid_1', '_ltv_USD', '_ltv_USD_timestamp', '_ltv_BRL', '_ltv_BRL_timestamp')] not found in axis"



```python

```

## Figure out why the data is missing

누락된 값을 처리하려면 값이 누락된 이유를 파악하기 위해 직관을 사용해야 합니다. 이것을 알아내는 데 도움이 되도록 스스로에게 물어볼 수 있는 가장 중요한 질문 중 하나는 다음과 같습니다.

이 값이 기록되지 않았거나 존재하지 않아서 누락된 것입니까?

- 값이 존재하지 않아서 누락된 경우, 값이 무엇인지 추측하는 것은 의미가 없기 때문에 NaN 값으로 처리. 
- 값이 기록되지 않아 누락된 경우, 해당 열과 행의 다른 값을 기반으로 했을 수 있는 값을 추측. (imputation)

### Drop missing values

급하거나 값이 누락된 이유를 파악할 이유가 없는 경우, 누락된 값이 포함된 행이나 열을 제거할 수 있다. (참고 : 일반적으로 중요한 프로젝트에는 이 접근 방식을 권장하지 않는다. 일반적으로 데이터를 살펴보고 누락된 값이 있는 모든 열을 하나씩 살펴보고 실제로 데이터 세트를 파악하는 데 시간을 할애하는 것이 좋다.)

누락된 값이 있는 행을 삭제할 경우, dropna().


```python
activity.dropna()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>items</th>
      <th>traffic_source_medium</th>
      <th>traffic_source_source</th>
      <th>traffic_source_name</th>
      <th>event_previous_timestamp</th>
      <th>ga_session_number</th>
      <th>ga_session_number_timestamp</th>
      <th>user_level</th>
      <th>user_level_timestamp</th>
      <th>frist_version</th>
      <th>...</th>
      <th>activity_name</th>
      <th>action_name</th>
      <th>activity_id</th>
      <th>action_id</th>
      <th>firebase_event_origin</th>
      <th>ga_session_number_1</th>
      <th>sub_name</th>
      <th>user_first_touch_timestamp</th>
      <th>stream_id</th>
      <th>event_timestamp</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows × 88 columns</p>
</div>



모든 데이터가 제거되었다. 이는 데이터 세트의 모든 행에 하나 이상의 결측값이 있기 때문이다. 대신 하나 이상의 결측값이 있는 모든 열을 제거하는 것이 더 나을 수 있습니다.


```python
columns_with_na_dropped = activity.dropna(axis=1)
columns_with_na_dropped.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>items</th>
      <th>user_level</th>
      <th>user_level_timestamp</th>
      <th>user_pseudo_id</th>
      <th>event_bundle_sequence_id</th>
      <th>platform</th>
      <th>event_server_timestamp_offset</th>
      <th>app_info_install_source</th>
      <th>app_info_firebase_app_id</th>
      <th>app_info_version</th>
      <th>...</th>
      <th>geo_continent</th>
      <th>sub_id</th>
      <th>activity_name</th>
      <th>action_name</th>
      <th>activity_id</th>
      <th>action_id</th>
      <th>firebase_event_origin</th>
      <th>sub_name</th>
      <th>stream_id</th>
      <th>event_timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[]</td>
      <td>111</td>
      <td>1619310355711000</td>
      <td>8da97c0b43305c41d78cc0f5585d6b9a</td>
      <td>1572</td>
      <td>ANDROID</td>
      <td>1651059</td>
      <td>com.android.vending</td>
      <td>1:142569243604:android:31c6a5c81e681fd8210c41</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>Americas</td>
      <td>1008</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>firefighter</td>
      <td>2205916636</td>
      <td>1619310355712000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[]</td>
      <td>116</td>
      <td>1619310716820000</td>
      <td>8da97c0b43305c41d78cc0f5585d6b9a</td>
      <td>1647</td>
      <td>ANDROID</td>
      <td>1681114</td>
      <td>com.android.vending</td>
      <td>1:142569243604:android:31c6a5c81e681fd8210c41</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>Americas</td>
      <td>0</td>
      <td>content_button</td>
      <td>close_collection</td>
      <td>3</td>
      <td>3002</td>
      <td>app</td>
      <td>0</td>
      <td>2205916636</td>
      <td>1619310716820000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[]</td>
      <td>135</td>
      <td>1619538999255000</td>
      <td>8da97c0b43305c41d78cc0f5585d6b9a</td>
      <td>2047</td>
      <td>ANDROID</td>
      <td>1436640</td>
      <td>com.android.vending</td>
      <td>1:142569243604:android:31c6a5c81e681fd8210c41</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>Americas</td>
      <td>1005</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>doctor</td>
      <td>2205916636</td>
      <td>1619538999256000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[]</td>
      <td>110</td>
      <td>1619310280808000</td>
      <td>8da97c0b43305c41d78cc0f5585d6b9a</td>
      <td>1554</td>
      <td>ANDROID</td>
      <td>1643764</td>
      <td>com.android.vending</td>
      <td>1:142569243604:android:31c6a5c81e681fd8210c41</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>Americas</td>
      <td>0</td>
      <td>content_button</td>
      <td>open_collection</td>
      <td>3</td>
      <td>3001</td>
      <td>app</td>
      <td>0</td>
      <td>2205916636</td>
      <td>1619310280808000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[]</td>
      <td>135</td>
      <td>1619539036765000</td>
      <td>8da97c0b43305c41d78cc0f5585d6b9a</td>
      <td>2068</td>
      <td>ANDROID</td>
      <td>1425169</td>
      <td>com.android.vending</td>
      <td>1:142569243604:android:31c6a5c81e681fd8210c41</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>Americas</td>
      <td>1007</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>police</td>
      <td>2205916636</td>
      <td>1619539036766000</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 33 columns</p>
</div>




```python
print("Columns in original dataset: %d \n" % activity.shape[1])
print("Columns with na's dropped: %d" % columns_with_na_dropped.shape[1])
```

    Columns in original dataset: 88 
    
    Columns with na's dropped: 33



```python
columns_with_na_dropped.columns
```




    Index(['items', 'user_level', 'user_level_timestamp', 'user_pseudo_id',
           'event_bundle_sequence_id', 'platform', 'event_server_timestamp_offset',
           'app_info_install_source', 'app_info_firebase_app_id',
           'app_info_version', 'app_info_id', 'event_date', 'event_name',
           'device_time_zone_offset_seconds', 'device_operating_system',
           'device_mobile_os_hardware_model', 'device_is_limited_ad_tracking',
           'device_operating_system_version', 'device_language', 'device_category',
           'geo_metro', 'geo_sub_continent', 'geo_country', 'geo_continent',
           'sub_id', 'activity_name', 'action_name', 'activity_id', 'action_id',
           'firebase_event_origin', 'sub_name', 'stream_id', 'event_timestamp'],
          dtype='object')




```python
# 전체가 결측값인 행 또는 열만 삭제
activity.dropna(how='all', axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>items</th>
      <th>traffic_source_medium</th>
      <th>traffic_source_source</th>
      <th>traffic_source_name</th>
      <th>event_previous_timestamp</th>
      <th>ga_session_number</th>
      <th>ga_session_number_timestamp</th>
      <th>user_level</th>
      <th>user_level_timestamp</th>
      <th>frist_version</th>
      <th>...</th>
      <th>activity_name</th>
      <th>action_name</th>
      <th>activity_id</th>
      <th>action_id</th>
      <th>firebase_event_origin</th>
      <th>ga_session_number_1</th>
      <th>sub_name</th>
      <th>user_first_touch_timestamp</th>
      <th>stream_id</th>
      <th>event_timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619310e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>111</td>
      <td>1619310355711000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>11.0</td>
      <td>firefighter</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310355712000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619311e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>116</td>
      <td>1619310716820000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>close_collection</td>
      <td>3</td>
      <td>3002</td>
      <td>app</td>
      <td>11.0</td>
      <td>0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310716820000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619538999255000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>doctor</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619538999256000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619309e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>110</td>
      <td>1619310280808000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>open_collection</td>
      <td>3</td>
      <td>3001</td>
      <td>app</td>
      <td>11.0</td>
      <td>0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310280808000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619539036765000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>police</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619539036766000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1210974</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619539024856000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>basic</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619539024856000</td>
    </tr>
    <tr>
      <th>1210975</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619309e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>107</td>
      <td>1619308894406000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>11.0</td>
      <td>worker</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619308894406000</td>
    </tr>
    <tr>
      <th>1210976</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619550e+15</td>
      <td>2.0</td>
      <td>1.619550e+15</td>
      <td>16</td>
      <td>1619550368873000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>2.0</td>
      <td>basic</td>
      <td>1.619197e+15</td>
      <td>2205916636</td>
      <td>1619550368873000</td>
    </tr>
    <tr>
      <th>1210977</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619550e+15</td>
      <td>2.0</td>
      <td>1.619550e+15</td>
      <td>16</td>
      <td>1619550361714000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>2.0</td>
      <td>pringles</td>
      <td>1.619197e+15</td>
      <td>2205916636</td>
      <td>1619550361715000</td>
    </tr>
    <tr>
      <th>1210978</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619550e+15</td>
      <td>2.0</td>
      <td>1.619550e+15</td>
      <td>18</td>
      <td>1619550449656000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>open_collection</td>
      <td>3</td>
      <td>3001</td>
      <td>app</td>
      <td>2.0</td>
      <td>0</td>
      <td>1.619197e+15</td>
      <td>2205916636</td>
      <td>1619550449656000</td>
    </tr>
  </tbody>
</table>
<p>1210979 rows × 85 columns</p>
</div>




```python
activity.dropna(how='all', axis=0)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>items</th>
      <th>traffic_source_medium</th>
      <th>traffic_source_source</th>
      <th>traffic_source_name</th>
      <th>event_previous_timestamp</th>
      <th>ga_session_number</th>
      <th>ga_session_number_timestamp</th>
      <th>user_level</th>
      <th>user_level_timestamp</th>
      <th>frist_version</th>
      <th>...</th>
      <th>activity_name</th>
      <th>action_name</th>
      <th>activity_id</th>
      <th>action_id</th>
      <th>firebase_event_origin</th>
      <th>ga_session_number_1</th>
      <th>sub_name</th>
      <th>user_first_touch_timestamp</th>
      <th>stream_id</th>
      <th>event_timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619310e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>111</td>
      <td>1619310355711000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>11.0</td>
      <td>firefighter</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310355712000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619311e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>116</td>
      <td>1619310716820000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>close_collection</td>
      <td>3</td>
      <td>3002</td>
      <td>app</td>
      <td>11.0</td>
      <td>0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310716820000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619538999255000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>doctor</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619538999256000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619309e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>110</td>
      <td>1619310280808000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>open_collection</td>
      <td>3</td>
      <td>3001</td>
      <td>app</td>
      <td>11.0</td>
      <td>0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310280808000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619539036765000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>police</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619539036766000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1210974</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619539024856000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>basic</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619539024856000</td>
    </tr>
    <tr>
      <th>1210975</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619309e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>107</td>
      <td>1619308894406000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>11.0</td>
      <td>worker</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619308894406000</td>
    </tr>
    <tr>
      <th>1210976</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619550e+15</td>
      <td>2.0</td>
      <td>1.619550e+15</td>
      <td>16</td>
      <td>1619550368873000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>2.0</td>
      <td>basic</td>
      <td>1.619197e+15</td>
      <td>2205916636</td>
      <td>1619550368873000</td>
    </tr>
    <tr>
      <th>1210977</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619550e+15</td>
      <td>2.0</td>
      <td>1.619550e+15</td>
      <td>16</td>
      <td>1619550361714000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>2.0</td>
      <td>pringles</td>
      <td>1.619197e+15</td>
      <td>2205916636</td>
      <td>1619550361715000</td>
    </tr>
    <tr>
      <th>1210978</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619550e+15</td>
      <td>2.0</td>
      <td>1.619550e+15</td>
      <td>18</td>
      <td>1619550449656000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>open_collection</td>
      <td>3</td>
      <td>3001</td>
      <td>app</td>
      <td>2.0</td>
      <td>0</td>
      <td>1.619197e+15</td>
      <td>2205916636</td>
      <td>1619550449656000</td>
    </tr>
  </tbody>
</table>
<p>1210979 rows × 88 columns</p>
</div>



thresh : optional 변수로 not-nan data 즉 value 값이 존재하는 nan이 아닌 데이터가 몇 개면 삭제하지 않을 것인지를 정하는 변수이다.


```python
# 임계치 설정해서 제거하기
activity.dropna(thresh=10, axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>items</th>
      <th>traffic_source_medium</th>
      <th>traffic_source_source</th>
      <th>traffic_source_name</th>
      <th>event_previous_timestamp</th>
      <th>ga_session_number</th>
      <th>ga_session_number_timestamp</th>
      <th>user_level</th>
      <th>user_level_timestamp</th>
      <th>frist_version</th>
      <th>...</th>
      <th>activity_name</th>
      <th>action_name</th>
      <th>activity_id</th>
      <th>action_id</th>
      <th>firebase_event_origin</th>
      <th>ga_session_number_1</th>
      <th>sub_name</th>
      <th>user_first_touch_timestamp</th>
      <th>stream_id</th>
      <th>event_timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619310e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>111</td>
      <td>1619310355711000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>11.0</td>
      <td>firefighter</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310355712000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619311e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>116</td>
      <td>1619310716820000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>close_collection</td>
      <td>3</td>
      <td>3002</td>
      <td>app</td>
      <td>11.0</td>
      <td>0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310716820000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619538999255000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>doctor</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619538999256000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619309e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>110</td>
      <td>1619310280808000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>open_collection</td>
      <td>3</td>
      <td>3001</td>
      <td>app</td>
      <td>11.0</td>
      <td>0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310280808000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619539036765000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>police</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619539036766000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1210974</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619539024856000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>basic</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619539024856000</td>
    </tr>
    <tr>
      <th>1210975</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619309e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>107</td>
      <td>1619308894406000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>11.0</td>
      <td>worker</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619308894406000</td>
    </tr>
    <tr>
      <th>1210976</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619550e+15</td>
      <td>2.0</td>
      <td>1.619550e+15</td>
      <td>16</td>
      <td>1619550368873000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>2.0</td>
      <td>basic</td>
      <td>1.619197e+15</td>
      <td>2205916636</td>
      <td>1619550368873000</td>
    </tr>
    <tr>
      <th>1210977</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619550e+15</td>
      <td>2.0</td>
      <td>1.619550e+15</td>
      <td>16</td>
      <td>1619550361714000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>2.0</td>
      <td>pringles</td>
      <td>1.619197e+15</td>
      <td>2205916636</td>
      <td>1619550361715000</td>
    </tr>
    <tr>
      <th>1210978</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619550e+15</td>
      <td>2.0</td>
      <td>1.619550e+15</td>
      <td>18</td>
      <td>1619550449656000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>open_collection</td>
      <td>3</td>
      <td>3001</td>
      <td>app</td>
      <td>2.0</td>
      <td>0</td>
      <td>1.619197e+15</td>
      <td>2205916636</td>
      <td>1619550449656000</td>
    </tr>
  </tbody>
</table>
<p>1210979 rows × 85 columns</p>
</div>




```python
# 특정 컬럼 내의 결측치만 삭제하려고 할 때
activity.dropna(subset=['items', 'ga_session_number'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>items</th>
      <th>traffic_source_medium</th>
      <th>traffic_source_source</th>
      <th>traffic_source_name</th>
      <th>event_previous_timestamp</th>
      <th>ga_session_number</th>
      <th>ga_session_number_timestamp</th>
      <th>user_level</th>
      <th>user_level_timestamp</th>
      <th>frist_version</th>
      <th>...</th>
      <th>activity_name</th>
      <th>action_name</th>
      <th>activity_id</th>
      <th>action_id</th>
      <th>firebase_event_origin</th>
      <th>ga_session_number_1</th>
      <th>sub_name</th>
      <th>user_first_touch_timestamp</th>
      <th>stream_id</th>
      <th>event_timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619310e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>111</td>
      <td>1619310355711000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>11.0</td>
      <td>firefighter</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310355712000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619311e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>116</td>
      <td>1619310716820000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>close_collection</td>
      <td>3</td>
      <td>3002</td>
      <td>app</td>
      <td>11.0</td>
      <td>0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310716820000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619538999255000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>doctor</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619538999256000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619309e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>110</td>
      <td>1619310280808000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>open_collection</td>
      <td>3</td>
      <td>3001</td>
      <td>app</td>
      <td>11.0</td>
      <td>0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310280808000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5.63939e+18</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619539036765000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>police</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619539036766000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1210974</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619539024856000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>16.0</td>
      <td>basic</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619539024856000</td>
    </tr>
    <tr>
      <th>1210975</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619309e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>107</td>
      <td>1619308894406000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>11.0</td>
      <td>worker</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619308894406000</td>
    </tr>
    <tr>
      <th>1210976</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619550e+15</td>
      <td>2.0</td>
      <td>1.619550e+15</td>
      <td>16</td>
      <td>1619550368873000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>2.0</td>
      <td>basic</td>
      <td>1.619197e+15</td>
      <td>2205916636</td>
      <td>1619550368873000</td>
    </tr>
    <tr>
      <th>1210977</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619550e+15</td>
      <td>2.0</td>
      <td>1.619550e+15</td>
      <td>16</td>
      <td>1619550361714000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>click_skin</td>
      <td>3</td>
      <td>3003</td>
      <td>app</td>
      <td>2.0</td>
      <td>pringles</td>
      <td>1.619197e+15</td>
      <td>2205916636</td>
      <td>1619550361715000</td>
    </tr>
    <tr>
      <th>1210978</th>
      <td>[]</td>
      <td>notification</td>
      <td>Firebase</td>
      <td>5639386036271637485</td>
      <td>1.619550e+15</td>
      <td>2.0</td>
      <td>1.619550e+15</td>
      <td>18</td>
      <td>1619550449656000</td>
      <td>1.5.2</td>
      <td>...</td>
      <td>content_button</td>
      <td>open_collection</td>
      <td>3</td>
      <td>3001</td>
      <td>app</td>
      <td>2.0</td>
      <td>0</td>
      <td>1.619197e+15</td>
      <td>2205916636</td>
      <td>1619550449656000</td>
    </tr>
  </tbody>
</table>
<p>1210772 rows × 88 columns</p>
</div>



### Filling in missing values automatically


```python

```

## Handling missing data


```python
def handling_missing_data(df):
    # 데이터 세트의 값 중 몇 퍼센트가 누락되었는지 확인
    print("how many total missing values do we have?")
    total_cells = np.product(df.shape)
    total_missing = missing_values_count.sum()
    print(round((total_missing/total_cells) * 100, 2), "%")
    
    #
    columns_with_na_dropped = activity.dropna(axis=1)
    columns_with_na_dropped.head()
    
```

## Scaling and normalization


```python
from scipy import stats
from mlxtend.preprocessing import minmax_scaling

import seaborn as sns
import matplotlib.pyplot as plt

# set seed for reproducibility
np.random.seed(0)
```


```python
cat_cols = activity.select_dtypes(exclude=['int64','float64']).columns
cat_cols
```




    Index(['items', 'traffic_source_medium', 'traffic_source_source',
           'traffic_source_name', 'frist_version', 'cuid', 'ad_id', 'last_gclid_1',
           'user_pseudo_id', 'platform', 'app_info_install_source',
           'app_info_firebase_app_id', 'app_info_version', 'app_info_id',
           'event_name', 'device_operating_system',
           'device_mobile_os_hardware_model', 'device_mobile_marketing_name',
           'device_is_limited_ad_tracking', 'device_advertising_id',
           'device_operating_system_version', 'device_mobile_model_name',
           'device_language', 'device_mobile_brand_name', 'device_category',
           'geo_metro', 'geo_sub_continent', 'geo_city', 'geo_region',
           'geo_country', 'geo_continent', 'ad_id_1', 'firebase_screen_class',
           'activity_name', 'action_name', 'firebase_event_origin', 'sub_name'],
          dtype='object')




```python
len(cat_cols)
```




    37




```python
num_colms = activity._get_numeric_data()
num_colms.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event_previous_timestamp</th>
      <th>ga_session_number</th>
      <th>ga_session_number_timestamp</th>
      <th>user_level</th>
      <th>user_level_timestamp</th>
      <th>frist_version_timestamp</th>
      <th>cuid_timestamp</th>
      <th>firebase_exp_8</th>
      <th>firebase_exp_8_timestamp</th>
      <th>firebase_exp_10</th>
      <th>...</th>
      <th>ga_session_id_1</th>
      <th>firebase_screen_id</th>
      <th>sub_id</th>
      <th>engaged_session_event</th>
      <th>activity_id</th>
      <th>action_id</th>
      <th>ga_session_number_1</th>
      <th>user_first_touch_timestamp</th>
      <th>stream_id</th>
      <th>event_timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.619310e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>111</td>
      <td>1619310355711000</td>
      <td>1.619310e+15</td>
      <td>1.619310e+15</td>
      <td>1.0</td>
      <td>1.619195e+15</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.619309e+09</td>
      <td>-8.255892e+18</td>
      <td>1008</td>
      <td>1.0</td>
      <td>3</td>
      <td>3003</td>
      <td>11.0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310355712000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.619311e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>116</td>
      <td>1619310716820000</td>
      <td>1.619310e+15</td>
      <td>1.619310e+15</td>
      <td>1.0</td>
      <td>1.619195e+15</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.619309e+09</td>
      <td>-8.255892e+18</td>
      <td>0</td>
      <td>1.0</td>
      <td>3</td>
      <td>3002</td>
      <td>11.0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310716820000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619538999255000</td>
      <td>1.619539e+15</td>
      <td>1.619539e+15</td>
      <td>1.0</td>
      <td>1.619195e+15</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.619539e+09</td>
      <td>2.995595e+18</td>
      <td>1005</td>
      <td>1.0</td>
      <td>3</td>
      <td>3003</td>
      <td>16.0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619538999256000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.619309e+15</td>
      <td>11.0</td>
      <td>1.619309e+15</td>
      <td>110</td>
      <td>1619310280808000</td>
      <td>1.619310e+15</td>
      <td>1.619310e+15</td>
      <td>1.0</td>
      <td>1.619195e+15</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.619309e+09</td>
      <td>-8.255892e+18</td>
      <td>0</td>
      <td>1.0</td>
      <td>3</td>
      <td>3001</td>
      <td>11.0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619310280808000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.619539e+15</td>
      <td>16.0</td>
      <td>1.619539e+15</td>
      <td>135</td>
      <td>1619539036765000</td>
      <td>1.619539e+15</td>
      <td>1.619539e+15</td>
      <td>1.0</td>
      <td>1.619195e+15</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.619539e+09</td>
      <td>2.995595e+18</td>
      <td>1007</td>
      <td>1.0</td>
      <td>3</td>
      <td>3003</td>
      <td>16.0</td>
      <td>1.619195e+15</td>
      <td>2205916636</td>
      <td>1619539036766000</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 52 columns</p>
</div>




```python
activity.nunique()
```




    items                               1
    traffic_source_medium               5
    traffic_source_source               5
    traffic_source_name                 7
    event_previous_timestamp      1042383
                                   ...   
    ga_session_number_1                44
    sub_name                           10
    user_first_touch_timestamp     160848
    stream_id                           1
    event_timestamp               1202693
    Length: 88, dtype: int64




```python
.drop_duplicates()
```
